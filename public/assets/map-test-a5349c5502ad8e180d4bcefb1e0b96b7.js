function initialize(){var e=new google.maps.LatLng(DefaultLat,DefaultLng),a={zoom:DefaultZoom,center:e,navigationControl:!0,scaleControl:!0,streetViewControl:!0,mapTypeId:google.maps.MapTypeId.ROADMAP};map=new google.maps.Map(document.getElementById("map_canvas"),a),google.maps.event.addListener(map,"zoom_changed",function(){this.getZoom()<DefaultZoom}),getDistance()}function getDistance(){google.maps.event.addListener(map,"click",function(e){addMarker(e.latLng)})}function addMarker(e){var a="http://labs.google.com/ridefinder/images/mm_20_red.png",r={position:e,draggable:!0,map:map,icon:a};if(marker=new google.maps.Marker(r),0==lenArray.length){var a="http://www.google.com/mapfiles/dd-start.png";marker.setIcon(a),origin=e}else lenArray.length>=2;google.maps.event.addListener(marker,"dragend",function(){drawOverlay()}),lenArray.push(marker),drawOverlay()}function drawOverlay(){var e=[];if(lenArray)for(i in lenArray)e.push(lenArray[i].getPosition());var a={path:e,map:map,strokeColor:"#FF0000",strokeOpacity:1,strokeWeight:2};if(polyline=new google.maps.Polyline(a),polylinesArray){for(i in polylinesArray)polylinesArray[i].setMap(null);polylinesArray=[]}polyline.setMap(map),polylinesArray.push(polyline);var r=new google.maps.DistanceMatrixService;r.getDistanceMatrix({origins:e,destinations:e,travelMode:google.maps.TravelMode.DRIVING,avoidHighways:!1,avoidTolls:!1},callback)}function deleteOverlays(){if(lenArray){for(i in lenArray)lenArray[i].setMap(null);lenArray.length=0}if(polylinesArray){for(i in polylinesArray)polylinesArray[i].setMap(null);polylinesArray=[]}var e=$("#result-calculate");e.empty(),$("#sum-distance").text(""),$("#sum-duration").text("")}function callback(e,a){if(a==google.maps.DistanceMatrixStatus.OK){var r=e.originAddresses,l=e.destinationAddresses,n=r.length-1,i=$("#result-calculate");i.empty();for(var t=0,o=0,s=0;n>s;s++){var p=e.rows[s].elements,d=s+1,g=p[d],y=g.distance.text,m=g.duration.text,c=r[s],u=l[d];t+=y,o+=m;var v='<div id="panel_'+d+'" class="panel panel-primary" onclick="focusMarker('+d+')"><div class="panel-heading"><h3 class="panel-title" id="title_'+d+'">\u5b50\u8def\u7ebf'+d+'</h3></div><div class="panel-body"><div id="info_'+d+'">\u8d77\u70b9\uff1a'+c+"<br>\u7ec8\u70b9\uff1a"+u+"<br>\u7528\u65f6\uff1a"+m+"<br>\u8def\u7a0b\uff1a"+y+"</div></div></div>";i.append(v)}$("#sum-distance").text(t),$("#sum-duration").text(o)}else alert(a)}var map,polyline,polylinesArray=[],lenArray=[],DefaultLat=22.786607,DefaultLng=100.977316,DefaultZoom=15,origin;